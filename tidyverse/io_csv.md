# CSV

- [CSV](#csv)
  - [简介](#简介)
  - [从字符串读入](#从字符串读入)
  - [编码设置](#编码设置)
  - [类型设置](#类型设置)

2020-08-25, 21:37
@jiawei
***

## 简介

对 CSV 文件格式，在 R 中可以用 `read.csv()`, `read.table()`, `read.delim()`, `read.fwf()` 等函数读入，但是建议使用 readr 包的 `read_csv()`, `read_table2()`, `read_delim()`, `read_fwf()` 等函数。

这些函数将读入的数据保存为 tibble 类型，读入速度比基本 R 的 `read.csv()` 等函数快许多，极端情况可以相差10倍，也不自动将字符串转换成因子，不自动修改变量名为合法变量名，不设置行名。

对于中小规模的数据， CSV格式作为文件交换格式比较合适， 兼容性强， 各种数据管理软件与统计软件都可以很容易地读入和生成这样格式的文件， 但是特别大型的数据读入效率很低。

CSV格式的文件用逗号分隔开同一行的数据项， 一般第一行是各列的列名（变量名）。 对于数值型数据， 只要表示成数值常量形式即可。 对于字符型数据， 可以用双撇号包围起来， 也可以不用撇号包围。 但是， 如果数据项本身包含逗号， 就需要用双撇号包围。

## 从字符串读入

## 编码设置

CSV文件是文本文件，有编码问题， 尤其是中文内容的文件。 readr包的默认编码是UTF-8编码。 例如，文件bp.csv以GBK编码（有时称为GB18030编码， 这是中文Windows所用的中文编码）保存了如下内容：

## 类型设置

对每列的类型， readr 用前 1000 行猜测合理的类型，并在读取后显示猜测的每列类型。

也可以使用 `col_types` 选项指定每列的类型。对应参数：

- `col_double()`
- `col_integer()`
- `col_character()`
- `col_factor()`
- `col_date()`
- `col_datetime`

`cols()` 函数可以用来规定各列类型，并且有一个 `.default` 参数指定缺省类型。对因子，需要在 `col_factor()` 中用 `levels=` 指定因子水平。



