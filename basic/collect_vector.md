# 向量

- [向量](#向量)
  - [简介](#简介)
  - [创建向量](#创建向量)
    - [创建时指定大小](#创建时指定大小)
    - [向量长度](#向量长度)
  - [元素命名](#元素命名)
  - [索引](#索引)
    - [单整数](#单整数)
    - [多整数](#多整数)
    - [删除指定位置元素](#删除指定位置元素)
    - [空下标](#空下标)
    - [`x[0]`](#x0)
    - [选择连续元素](#选择连续元素)
  - [根据名称选择](#根据名称选择)
  - [向量运算](#向量运算)
    - [标量和向量](#标量和向量)
    - [等长向量与向量](#等长向量与向量)
    - [不等长常量与向量](#不等长常量与向量)
  - [向量函数](#向量函数)
    - [向量化函数](#向量化函数)
    - [排序函数](#排序函数)
  - [逻辑向量](#逻辑向量)
  - [which](#which)

2020-05-14, 09:41
*** **

## 简介

向量，用于保存**相同类型数据**。R 中，单个数值没有单独的数据类型，而是作为向量的一种特例。

在R中，向量的大小在创建时已经确定，因此如果要添加或删除元素，需要重新给向量赋值。

## 创建向量

通过 `c()` 函数（表示连接，Concatenate），创建向量:

```r
> apple <- c("red", "green", "yellow")
> apple
[1] "red"    "green"  "yellow"
> class(apple)
[1] "character"
```

数值向量：

```r
> die <- c(2, 4, 6)
> die
[1] 2 4 6
> class(die)
[1] "numeric"
```

范围：

```r
> x <- c(1:3, 10:13)
> x
[1]  1  2  3 10 11 12 13
```

多类型，自动转换为字符串：

```r
> v <- c('Z', 1, TRUE)
> v
[1] "Z"    "1"    "TRUE"
> class(v)
[1] "character"
```

### 创建时指定大小

```r
y <- vector(length = 2)
```

### 向量长度

使用 `length()` 获取向量长度：

```r
> x <- c(1)
> length(x)
[1] 1
> x <- c(1, 2, 3)
> length(x)
[1] 3
```

## 元素命名

```r
names(roulette_vector) <- c("Monday", "Tuesday", "Wednesday", "Thursday", "Friday")
```

为向量 `roulette_vector` 每个元素命名。

## 索引

说明：

- `x[i]` 选择第 `i` 个元素
- `x[c(a, b)]` 选择第 `a`, `b` 两个元素
- `x[i] <- k` 将第 `i` 个元素修改为 `k`
- `x[c(i, j)] <- c(m, n)` 将第 `i`, `j` 两个元素修改为 `m` 和 `n`
- `x[-i]` 返回一个移除第 `i` 个元素的向量
- `x[]` 取 x 得全部元素作为子集

### 单整数

```r
> a <- c(1, 2, 5, 3)
> a[3]
[1] 5
```

> R 的索引以 1 开始

使用 `x[1] <- 6` 语法可以修改第一个元素的值。

```r
> x <- c(6, 6.25, 7.45)
> x[1]
[1] 6
> x[1] <- 6.15
> x
[1] 6.15 6.25 7.45
```

### 多整数

选择多个元素，如选择第1和5两个元素：

```r
> x <- c(1.1, 2.2, 3.3, 4.4, 5.5)
> x[c(3, 1)]
[1] 3.3 1.1
```

`[]` 中为向量，返回的元素按照提供索引的顺序返回。

修改值：

```r
> x
[1] 6.15 6.25 7.45
> x[c(1, 3)]
[1] 6.15 7.45
> x[c(1, 3)] <- c(6, 8)
> x
[1] 6.00 6.25 8.00
```

### 删除指定位置元素

提供负数索引删除元素。例如，删除第二个元素：

```r
> x <- c(1.1, 2.2, 3.3, 4.4, 5.5)
> x[-2]
[1] 1.1 3.3 4.4 5.5
> x
[1] 1.1 2.2 3.3 4.4 5.5
```

可以看到，原向量不变，而是生成一个新的向量。

删除多个元素：

```r
> x <- c(1, 2, 3)
> x[-c(1, 3)]
[1] 2
```

### 空下标

`x[]` 取 x 全部元素。例如：

```r
> x <- c(1, 2, 3)
> y <- x[] # y 和 x 元素完全相同
> y
[1] 1 2 3
> y[] <- 61 # 给 y 的每个元素依次赋值
> y
[1] 61 61 61
> x
[1] 1 2 3
> x <- 61 # 给 x 赋值
> x
[1] 61
```

### `x[0]`

`x[0]` 返回类型相同、长度为零的向量，如 `numeric(0)`。相当于空集。

当 0 与正整数或负整数下标一起使用时被忽略。

例如：

```r
> x <- c(1, 2, 3)
> y <- x[0]
> class(y)
[1] "numeric"
> length(y)
[1] 0
```

### 选择连续元素

```r
a_vector[2:4]
```

等价于 `a_vector[c(2, 3, 4)]`

## 根据名称选择

对命名向量，可以根据名称选择：

```r
> y <- c("a" =  11, "b" =  12, "c" =  13, "d" =  14)
> y
 a  b  c  d
11 12 13 14
> y[c("d", "a")]
 d  a
14 11
```

返回的元素顺序依然是按照提供的索引顺序。

## 向量运算

### 标量和向量

R 没有单独的标量类型，标量实际上是长度为 1 的向量。

向量与标量运算，向量的每个元素依次与标量运算。即线性代数中的数乘。如：

```r
> x <- c(1, 5, 10)
> x+2
[1]  3  7 12
> x-2
[1] -1  3  8
> x*2
[1]  2 10 20
> x/2
[1] 0.5 2.5 5.0
> x^2
[1]   1  25 100
> 2/x
[1] 2.0 0.4 0.2
> 2^x
[1]    2   32 1024
```

如果向量中存在缺失值，计算后依旧缺失：

```r
> c(1, NA, 2) + 10
[1] 11 NA 12
```

### 等长向量与向量

等长向量的运算，为对应元素的两两运算：

```r
> a <- c(1, 10)
> b <- c(4, 2)
> a+b
[1]  5 12
> a-b
[1] -3  8
> a*b
[1]  4 20
> a/b
[1] 0.25 5.00
```

### 不等长常量与向量

对不等长向量的数学运算，如果长度为倍数关系，则重复利用短的向量：

```r
> a <- c(10, 20)
> b <- c(1, 3, 5, 7)
> a+b
[1] 11 23 15 27
> a*b
[1]  10  60  50 140
```

如果两个向量长度不是倍数关系，会给出警告信息：

```r
> c(1, 2) + c(1, 2, 3)
[1] 2 4 4
Warning message:
In c(1, 2) + c(1, 2, 3) :
  longer object length is not a multiple of shorter object length
```

## 向量函数

### 向量化函数

R 中的函数一般都是向量化的，在R中，如果普通的一元函数以向量为自变量，一般会对每个元素依次计算。如 sqrt, log, log10, exp, sin, cos, tan 等。

例如常用的数学函数：

- 舍入：ceiling, floor, round, signif, trunc, zapsmall
- 符号函数 sign
- 绝对值 abs
- 平方根 sqrt
- 对数与指数函数 log, exp, log10, log2
- 三角函数 sin, cos, tan
- 反三角函数 asin, acos, atan, atan2
- 双曲函数 sinh, cosh, tanh
- 反双曲函数 asinh, acosh, atanh

如果自己编写的函数没有考虑向量化问题，可以用 `Vectorize()` 函数将其转换为向量化版本。

### 排序函数

- `sort(x)` 返回排序结果。
- `rev(x)` 将 `x` 的各元素的顺序反转
- `order(x)` 返回排序下标

例如：

```r
> x <- c(3, 5, 2)
> sort(x) # 返回排序后的结果
[1] 2 3 5
> rev(x) # 将 x 的元素顺序反转
[1] 2 5 3
> rev(sort(x)) # 实现降序排列
[1] 5 3 2
> order(x) # 返回各元素的位置，3 表示最小元素是第三个
[1] 3 1 2
> x[order(x)] # 等价于 sort(x)
[1] 2 3 5
```

## 逻辑向量

将对应位置为 `TRUE` 的元素选择出来。例如：

```r
> x[c(TRUE, FALSE, TRUE, FALSE, TRUE)]
[1] 1.1 3.3 5.5
> x
[1] 1.1 2.2 3.3 4.4 5.5
```

这种方式，依然是返回一个新的向量。

逻辑计算：

- 向量与标量的计算，向量的每个元素与标量一次计算
- 等长向量的运算，对应元素依次运算
- 与 NA 比较生成 NA

```r
[1] TRUE
> c(1, 3, 5) > 2
[1] FALSE  TRUE  TRUE
> (1: 4) >= (4:1)
[1] FALSE FALSE  TRUE  TRUE
> c(1, NA, 3) > 2
[1] FALSE    NA  TRUE
> NA == NA
[1] NA
```

逻辑选择：

```r
> x <- c(1, 4, 6)
> x[x>3]
[1] 4 6
```

通过 `is.na()` 函数判断是否为 NA:

```r
> is.na(c(1, NA, 3) > 2)
[1] FALSE  TRUE FALSE
```

用 `is.finite()` 判断是否为 inf 值：

## which

`which()` 可以用来找到满足条件的下标，例如：

